{"version":3,"sources":["webpack:///webpack/bootstrap fbf3c79cde8aa7df5a83","webpack:///external \"fs\"","webpack:///external \"path\"","webpack:///./src/GulpSassPedigree.js","webpack:///./src/DependenciesGraph.js","webpack:///./src/Helpers.js","webpack:///./src/stripScssImports.js","webpack:///external \"gulp-util\"","webpack:///external \"through2\""],"names":["createPedigree","getAncestors","graph","PLUGIN_NAME","options","includePaths","sassPedigreeStudy","file","enc","cb","isNull","onFileChange","contents","toString","dirname","path","base","sassPedigreeGetAncestors","start","Date","now","parents","get","length","ancestors","ascend","slice","forEach","push","File","cwd","p","type","createReadStream","readFileSync","stats","filename","log","colors","bgYellow","JSON","stringify","magenta","_options","Object","assign","obj","DependenciesGraph","create","children","oldDeps","newDeps","concat","cache","list","res","shift","dep","content","dir","imports","updateKeys","createStack","updateChildren","updateParents","k","indexOf","files","dirs","map","i","a","resolve","b","replace","existsSync","keys","prune","arr","filter","child","lastIndexOf","stripScssImports","textContent","match","reduce","split"],"mappings":"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","file":"GulpSassPedigree.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// identity function for calling harmony imports with the correct context\n \t__webpack_require__.i = function(value) { return value; };\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 8);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap fbf3c79cde8aa7df5a83","module.exports = require(\"fs\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"fs\"\n// module id = 0\n// module chunks = 0","module.exports = require(\"path\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"path\"\n// module id = 1\n// module chunks = 0","import through from 'through2';\r\nimport path from 'path';\r\nimport fs from 'fs';\r\nimport gutil from 'gulp-util';\r\n\r\nimport {DependenciesGraph} from './DependenciesGraph';\r\n\r\nconst graph = new DependenciesGraph();\r\nconst PLUGIN_NAME = 'gulp-sass-pedigree';\r\n\r\nlet options = {\r\n  includePaths: []\r\n};\r\n\r\n\r\nfunction sassPedigreeStudy(file, enc, cb) {\r\n  graph.options = options;\r\n\r\n  if(file && !file.isNull()) {\r\n    void graph.onFileChange(\r\n      file,\r\n      file.contents.toString(),\r\n      [\r\n        path.dirname(file.path),\r\n        file.base\r\n      ]\r\n    );\r\n  }\r\n\r\n  return cb(null, file);\r\n}\r\n\r\n\r\nfunction sassPedigreeGetAncestors(file, enc, cb) {\r\n  let start = Date.now();\r\n\r\n  if(!file || file.isNull()) {\r\n    return cb(null, file);\r\n  }\r\n\r\n  void graph.onFileChange(\r\n    file,\r\n    file.contents.toString(),\r\n    [\r\n      path.dirname(file.path),\r\n      file.base\r\n    ]\r\n  );\r\n\r\n  let parents = graph.get(file.path).parents;\r\n\r\n  if(parents.length) {\r\n    let ancestors = graph.ascend(parents.slice());\r\n\r\n    ancestors\r\n      .forEach(p => {\r\n        this.push(\r\n          new gutil.File({\r\n            cwd: file.cwd,\r\n            path: p,\r\n            base: path.dirname(p),\r\n            contents: file.type === 'stream' ?\r\n              fs.createReadStream(p) : fs.readFileSync(p)\r\n          })\r\n        );\r\n      })\r\n    ;\r\n\r\n    let stats = {\r\n      ancestors: ancestors.length,\r\n      file: file.filename\r\n    };\r\n\r\n    gutil.log(\r\n      gutil.colors.bgYellow(\r\n        ` ${PLUGIN_NAME}: ${JSON.stringify(stats)} `\r\n      ),\r\n      gutil.colors.magenta(`${Date.now() - start} ms`)\r\n    );\r\n  }\r\n\r\n  return cb(null, file);\r\n}\r\n\r\nexport function createPedigree(_options) {\r\n  options = Object.assign({}, options, _options);\r\n\r\n  return through.obj(sassPedigreeStudy);\r\n}\r\nexport function getAncestors() {\r\n  return through.obj(sassPedigreeGetAncestors);\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/GulpSassPedigree.js","import path from 'path';\r\nimport fs from 'fs';\r\nimport {prune} from './Helpers';\r\nimport {stripScssImports} from './stripScssImports';\r\n\r\nexport class DependenciesGraph {\r\n  static createStack() {\r\n\r\n    return Object.assign(Object.create(null), {children: [], parents: []});\r\n  }\r\n\r\n  static updateChildren(oldDeps, newDeps) {\r\n\r\n    return prune([].concat(newDeps));\r\n  }\r\n\r\n  constructor() {\r\n    this.cache = Object.create(null);\r\n  }\r\n\r\n  get length() {\r\n\r\n    return Object.keys(this.cache).length;\r\n  }\r\n\r\n  get(path) {\r\n\r\n    return this.cache[path];\r\n  }\r\n\r\n  ascend(list, res = []) {\r\n    if(!list.length) {\r\n      return prune(res);\r\n    }\r\n\r\n    let p = list.shift();\r\n    let dep = this.cache[p];\r\n\r\n    return dep.parents.length ?\r\n      this.ascend(list.concat(dep.parents), res) :\r\n      this.ascend(list, res.concat(p))\r\n      ;\r\n  }\r\n\r\n  onFileChange(file, content, dir) {\r\n    let imports = this.updateKeys(stripScssImports(content), dir);\r\n\r\n    if(!this.cache[file.path]) {\r\n      this.cache[file.path] = DependenciesGraph.createStack();\r\n    }\r\n\r\n    this.cache[file.path].children = DependenciesGraph.updateChildren(\r\n      this.cache[file.path].children, imports\r\n    );\r\n\r\n    void this.updateParents();\r\n  }\r\n\r\n  updateParents() {\r\n    for(let k in this.cache) {\r\n      //noinspection JSUnfilteredForInLoop\r\n      this.cache[k].parents = [];\r\n    }\r\n\r\n    for(let k in this.cache) {\r\n      //noinspection JSUnfilteredForInLoop\r\n      this.cache[k]\r\n        .children\r\n        .forEach(file => {\r\n\r\n          //noinspection JSUnfilteredForInLoop\r\n          if(!~this.cache[file].parents.indexOf(k)) {\r\n            //noinspection JSUnfilteredForInLoop\r\n            this.cache[file].parents.push(k);\r\n          }\r\n        })\r\n      ;\r\n    }\r\n  }\r\n\r\n\r\n\r\n  updateKeys(files, dirs) {\r\n\r\n    return files\r\n      .map(filename => {\r\n        for(let i = 0; i < dirs.length; i++) {\r\n          let dir = dirs[i];\r\n          let a = path.resolve(dir, filename);\r\n          let b = a.replace(/([^/\\\\]*$)/, '_$1');\r\n\r\n          if(a in this.cache) {\r\n\r\n            return a;\r\n          }\r\n\r\n          if(b in this.cache) {\r\n\r\n            return b;\r\n          }\r\n\r\n          if(fs.existsSync(a)) {\r\n            this.cache[a] = DependenciesGraph.createStack();\r\n\r\n            return a;\r\n          }\r\n\r\n          if(fs.existsSync(b)) {\r\n            this.cache[b] = DependenciesGraph.createStack();\r\n\r\n            return b;\r\n          }\r\n        }\r\n      }, [])\r\n      ;\r\n  }\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/DependenciesGraph.js","export function prune(arr) {\r\n  return arr.filter((child, i, list) => child && i === list.lastIndexOf(child));\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/Helpers.js","export function stripScssImports(textContent) {\r\n\r\n  return (\r\n    // TODO: Handle comments //@import \"\"; or /* @import \"\"; */\r\n    textContent.match(/(?:@import\\s+)([^;]*)/g) || []\r\n  )\r\n    .reduce((res, filename) => res.concat(\r\n      filename\r\n        .replace(/@import|[\"'\\s]/g, '')\r\n        .split(/,/)\r\n        .map(p => `${p.replace(/\\.scss$/, '')}.scss`)\r\n      )\r\n      , [])\r\n    ;\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/stripScssImports.js","module.exports = require(\"gulp-util\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"gulp-util\"\n// module id = 6\n// module chunks = 0","module.exports = require(\"through2\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"through2\"\n// module id = 7\n// module chunks = 0"],"sourceRoot":""}