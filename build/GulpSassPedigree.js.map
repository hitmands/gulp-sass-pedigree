{"version":3,"sources":["webpack:///webpack/bootstrap 31ded903521e90b15c17","webpack:///external \"fs\"","webpack:///external \"path\"","webpack:///./src/GulpSassPedigree.js","webpack:///./src/DependenciesGraph.js","webpack:///./src/Helpers.js","webpack:///./src/stripScssImports.js","webpack:///external \"gulp-util\"","webpack:///external \"through2\""],"names":["createPedigree","getAncestors","graph","PLUGIN_NAME","sassPedigreeStudy","file","enc","cb","options","isNull","onFileChange","contents","toString","dirname","path","base","concat","includePaths","sassPedigreeGetAncestors","start","Date","now","parents","get","length","ancestors","ascend","slice","forEach","push","File","cwd","p","type","createReadStream","readFileSync","stats","filename","log","colors","bgYellow","JSON","stringify","magenta","_options","obj","DependenciesGraph","Object","assign","create","children","oldDeps","newDeps","cache","fileExists","list","res","shift","dep","content","dir","imports","updateKeys","createStack","updateChildren","updateParents","k","indexOf","files","dirs","map","i","a","resolve","b","replace","v","keys","prune","arr","filter","child","lastIndexOf","existsSync","stripScssImports","textContent","match","reduce","split"],"mappings":"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","file":"GulpSassPedigree.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// identity function for calling harmony imports with the correct context\n \t__webpack_require__.i = function(value) { return value; };\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 8);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap 31ded903521e90b15c17","module.exports = require(\"fs\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"fs\"\n// module id = 0\n// module chunks = 0","module.exports = require(\"path\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"path\"\n// module id = 1\n// module chunks = 0","import through from 'through2';\r\nimport path from 'path';\r\nimport fs from 'fs';\r\nimport gutil from 'gulp-util';\r\n\r\nimport {DependenciesGraph} from './DependenciesGraph';\r\n\r\n\r\nconst graph = new DependenciesGraph();\r\nconst PLUGIN_NAME = 'gulp-sass-pedigree';\r\n\r\n\r\nfunction sassPedigreeStudy(file, enc, cb) {\r\n  graph.options = options;\r\n\r\n  if(file && !file.isNull()) {\r\n    void graph.onFileChange(\r\n      file,\r\n      file.contents.toString(),\r\n      [\r\n        path.dirname(file.path),\r\n        file.base\r\n      ].concat(graph.options.includePaths)\r\n    );\r\n  }\r\n\r\n  return cb(null, file);\r\n}\r\n\r\n\r\nfunction sassPedigreeGetAncestors(file, enc, cb) {\r\n  let start = Date.now();\r\n\r\n  if(!file || file.isNull()) {\r\n    return cb(null, file);\r\n  }\r\n\r\n  void graph.onFileChange(\r\n    file,\r\n    file.contents.toString(),\r\n    [\r\n      path.dirname(file.path),\r\n      file.base\r\n    ]\r\n  );\r\n\r\n  let parents = graph.get(file.path).parents;\r\n\r\n  if(parents.length) {\r\n    let ancestors = graph.ascend(parents.slice());\r\n\r\n    ancestors\r\n      .forEach(p => {\r\n        this.push(\r\n          new gutil.File({\r\n            cwd: file.cwd,\r\n            path: p,\r\n            base: path.dirname(p),\r\n            contents: file.type === 'stream' ?\r\n              fs.createReadStream(p) : fs.readFileSync(p)\r\n          })\r\n        );\r\n      })\r\n    ;\r\n\r\n    let stats = {\r\n      ancestors: ancestors.length,\r\n      file: file.filename\r\n    };\r\n\r\n    gutil.log(\r\n      gutil.colors.bgYellow(\r\n        ` ${PLUGIN_NAME}: ${JSON.stringify(stats)} `\r\n      ),\r\n      gutil.colors.magenta(`${Date.now() - start} ms`)\r\n    );\r\n  }\r\n\r\n  return cb(null, file);\r\n}\r\n\r\nexport function createPedigree(_options) {\r\n  graph.options = _options;\r\n\r\n  return through.obj(sassPedigreeStudy);\r\n}\r\nexport function getAncestors() {\r\n  return through.obj(sassPedigreeGetAncestors);\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/GulpSassPedigree.js","import path from 'path';\r\nimport {prune, fileExists} from './Helpers';\r\nimport {stripScssImports} from './stripScssImports';\r\n\r\nexport class DependenciesGraph {\r\n  static createStack() {\r\n\r\n    return Object.assign(Object.create(null), {children: [], parents: []});\r\n  }\r\n\r\n  static updateChildren(oldDeps, newDeps) {\r\n\r\n    return prune([].concat(newDeps));\r\n  }\r\n\r\n  constructor() {\r\n    this.cache = Object.create(null);\r\n    this.options = Object.assign(Object.create(null), {\r\n      fileExists\r\n    });\r\n  }\r\n\r\n  set options(v) {\r\n\r\n    this._options = Object.assign(this._options, v);\r\n  }\r\n  get options() {\r\n\r\n    return this._options;\r\n  }\r\n\r\n  get length() {\r\n\r\n    return Object.keys(this.cache).length;\r\n  }\r\n\r\n  get(path) {\r\n\r\n    return this.cache[path] || null;\r\n  }\r\n\r\n  ascend(list, res = []) {\r\n    if(!list.length) {\r\n      return prune(res);\r\n    }\r\n\r\n    let p = list.shift();\r\n    let dep = this.cache[p];\r\n\r\n    return dep.parents.length ?\r\n      this.ascend(list.concat(dep.parents), res) :\r\n      this.ascend(list, res.concat(p))\r\n      ;\r\n  }\r\n\r\n  onFileChange(file, content, dir) {\r\n    let imports = this.updateKeys(stripScssImports(content), dir);\r\n\r\n    if(!this.cache[file.path]) {\r\n      this.cache[file.path] = DependenciesGraph.createStack();\r\n    }\r\n\r\n    this.cache[file.path].children = DependenciesGraph.updateChildren(\r\n      this.cache[file.path].children, imports\r\n    );\r\n\r\n    void this.updateParents();\r\n  }\r\n\r\n  updateParents() {\r\n    for(let k in this.cache) {\r\n      //noinspection JSUnfilteredForInLoop\r\n      this.cache[k].parents = [];\r\n    }\r\n\r\n    for(let k in this.cache) {\r\n      //noinspection JSUnfilteredForInLoop\r\n      this.cache[k]\r\n        .children\r\n        .forEach(file => {\r\n\r\n          //noinspection JSUnfilteredForInLoop\r\n          if(!~this.cache[file].parents.indexOf(k)) {\r\n            //noinspection JSUnfilteredForInLoop\r\n            this.cache[file].parents.push(k);\r\n          }\r\n        })\r\n      ;\r\n    }\r\n  }\r\n\r\n\r\n  updateKeys(files, dirs) {\r\n\r\n    return files\r\n      .map(filename => {\r\n        for(let i = 0; i < dirs.length; i++) {\r\n          let dir = dirs[i];\r\n          let a = path.resolve(dir, filename);\r\n          let b = a.replace(/([^/\\\\]*$)/, '_$1');\r\n\r\n          if(a in this.cache) {\r\n\r\n            return a;\r\n          }\r\n\r\n          if(b in this.cache) {\r\n\r\n            return b;\r\n          }\r\n\r\n          if(this.options.fileExists(a)) {\r\n            this.cache[a] = DependenciesGraph.createStack();\r\n\r\n            return a;\r\n          }\r\n\r\n          if(this.options.fileExists(b)) {\r\n            this.cache[b] = DependenciesGraph.createStack();\r\n\r\n            return b;\r\n          }\r\n        }\r\n\r\n\r\n      }, [])\r\n      ;\r\n  }\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/DependenciesGraph.js","import fs from 'fs';\r\n\r\nexport function prune(arr) {\r\n  return arr.filter((child, i, list) => child && i === list.lastIndexOf(child));\r\n}\r\n\r\nexport function fileExists(path) {\r\n  return fs.existsSync(path);\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/Helpers.js","export function stripScssImports(textContent) {\r\n\r\n  return (\r\n    // TODO: Handle comments //@import \"\"; or /* @import \"\"; */\r\n    textContent.match(/(?:@import\\s+)([^;]*)/g) || []\r\n  )\r\n    .reduce((res, filename) => res.concat(\r\n      filename\r\n        .replace(/@import|[\"'\\s]/g, '')\r\n        .split(/,/)\r\n        .map(p => `${p.replace(/\\.scss$/, '')}.scss`)\r\n      )\r\n      , [])\r\n    ;\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/stripScssImports.js","module.exports = require(\"gulp-util\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"gulp-util\"\n// module id = 6\n// module chunks = 0","module.exports = require(\"through2\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"through2\"\n// module id = 7\n// module chunks = 0"],"sourceRoot":""}